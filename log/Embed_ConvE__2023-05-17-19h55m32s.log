2023-05-17 19:55:40,220 - [Embed_ConvE__2023-05-17-19h55m32s] - Embed_ConvE(
  (embeddings): Embeddings(
    (ent_embeddings): Parameters(14541, 200),
    (rel_embeddings): Parameters(474, 200)
    )
  (decoder): ConvE(
    (convolutions): ModuleList(
      (0): Sequential(
        (0): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (1): Conv2d(1, 200, kernel_size=(7, 7), stride=(1, 1), bias=False)
        (2): BatchNorm2d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (3): ReLU()
        (4): Dropout(p=0.2, inplace=False)
        (5): Flatten(start_dim=1, end_dim=-1)
        (6): Linear(in_features=39200, out_features=200, bias=True)
        (7): Dropout(p=0.3, inplace=False)
        (8): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (9): ReLU()
      )
    )
  )
  (bce_loss): BCELoss()
)
2023-05-17 19:55:40,221 - [Embed_ConvE__2023-05-17-19h55m32s] - 
DATA:
  NAME: FB15k237
  SMOOTH: 0.1
DECODER:
  CONVE_BIAS: False
  DECODER_FEAT_DROP: 0.2
  DECODER_HID_DROP: 0.3
  GAMMA: 40
  KER_SZ: 7
  K_H: 20
  K_W: 10
  NAME: ConvE
  NUM_FILTERS: 200
ENCODER:
  BIAS: False
  EMBED_DIM: 200
  ENCODER_DROP1: 0.3
  ENCODER_DROP2: 0.3
  ENCODER_GCN_BIAS: False
  ENCODER_GCN_DROP: 0.1
  GCN_HIDDEN_CHANNELS: 200
  GCN_IN_CHANNELS: 200
  GCN_NUM_LAYERS: 2
  GCN_OPN: sub
  GCN_OUT_CHANNELS: 200
  NAME: Embed
  NUM_BASES: -1
TRAIN:
  BATCH_SIZE: 256
  DEBUG: False
  EARLY_STOP_CNT: 30
  GPU: 2
  LENGTH: 3
  LOG_STEP: 100
  LR: 0.0001
  MAX_EPOCH: 1000
  NUM_WORKERS: 10
  SEED: 41504
  USE_APEX: False
  WEIGHT_DECAY: 0.0
2023-05-17 19:56:05,578 - [Embed_ConvE__2023-05-17-19h55m32s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  204.12 | 0.25358 | 0.16926 | 0.26444 | 0.43687 |
| lhs_original |  628.85 | 0.09378 | 0.03992 | 0.09049 | 0.20849 |
| avg_original | 416.485 | 0.17368 | 0.10459 | 0.17747 | 0.32268 |
|              |         |         |         |         |         |
| rhs_filtered |  175.65 | 0.43163 | 0.33475 | 0.47699 | 0.62362 |
| lhs_filtered |  344.19 |  0.2324 | 0.14673 | 0.25662 | 0.40946 |
| avg_filtered |  259.92 | 0.33202 | 0.24074 | 0.36681 | 0.51654 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 19:56:29,694 - [Embed_ConvE__2023-05-17-19h55m32s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  202.8  | 0.25338 | 0.16906 | 0.26429 | 0.43682 |
| lhs_original |  638.6  | 0.09318 | 0.03958 | 0.08966 | 0.20766 |
| avg_original |  420.7  | 0.17328 | 0.10432 | 0.17698 | 0.32224 |
|              |         |         |         |         |         |
| rhs_filtered |  174.19 | 0.43199 | 0.33534 | 0.47708 |  0.6244 |
| lhs_filtered |  343.82 | 0.23204 | 0.14658 | 0.25633 | 0.40907 |
| avg_filtered | 259.005 | 0.33202 | 0.24096 | 0.36671 | 0.51673 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 19:56:54,958 - [Embed_ConvE__2023-05-17-19h55m32s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  201.58 | 0.25321 | 0.16896 |  0.264  | 0.43653 |
| lhs_original |  650.74 | 0.09262 | 0.03924 | 0.08932 | 0.20644 |
| avg_original |  426.16 | 0.17291 |  0.1041 | 0.17666 | 0.32149 |
|              |         |         |         |         |         |
| rhs_filtered |  172.81 | 0.43217 | 0.33558 | 0.47718 | 0.62469 |
| lhs_filtered |  343.62 | 0.23167 | 0.14658 | 0.25559 | 0.40902 |
| avg_filtered | 258.215 | 0.33192 | 0.24108 | 0.36638 | 0.51685 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 19:57:19,783 - [Embed_ConvE__2023-05-17-19h55m32s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  200.36 | 0.25316 | 0.16896 | 0.26395 | 0.43624 |
| lhs_original |  666.31 | 0.09198 | 0.03904 | 0.08878 | 0.20507 |
| avg_original | 433.335 | 0.17257 |  0.104  | 0.17636 | 0.32066 |
|              |         |         |         |         |         |
| rhs_filtered |  171.48 | 0.43225 | 0.33573 | 0.47733 | 0.62425 |
| lhs_filtered |  343.58 | 0.23046 | 0.14551 |  0.2552 |  0.4057 |
| avg_filtered |  257.53 | 0.33136 | 0.24062 | 0.36626 | 0.51497 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 19:57:43,804 - [Embed_ConvE__2023-05-17-19h55m32s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  199.17 | 0.25302 | 0.16887 | 0.26375 | 0.43604 |
| lhs_original |  682.33 | 0.09105 | 0.03865 |  0.0881 | 0.20297 |
| avg_original |  440.75 | 0.17204 | 0.10376 | 0.17592 |  0.3195 |
|              |         |         |         |         |         |
| rhs_filtered |  170.21 | 0.43215 | 0.33563 | 0.47704 | 0.62411 |
| lhs_filtered |  343.8  | 0.22887 | 0.14492 | 0.25354 | 0.40047 |
| avg_filtered | 257.005 | 0.33051 | 0.24027 | 0.36529 | 0.51229 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 19:58:08,106 - [Embed_ConvE__2023-05-17-19h55m32s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  198.01 | 0.25304 | 0.16887 | 0.26371 | 0.43604 |
| lhs_original |  691.84 | 0.09103 |  0.0387 |  0.0881 | 0.20287 |
| avg_original | 444.925 | 0.17203 | 0.10378 | 0.17591 | 0.31945 |
|              |         |         |         |         |         |
| rhs_filtered |  169.0  | 0.43217 | 0.33573 | 0.47704 | 0.62386 |
| lhs_filtered |  344.12 | 0.22723 | 0.14375 | 0.25159 | 0.39798 |
| avg_filtered |  256.56 |  0.3297 | 0.23974 | 0.36431 | 0.51092 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 19:58:32,195 - [Embed_ConvE__2023-05-17-19h55m32s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  196.89 | 0.25303 | 0.16887 | 0.26366 | 0.43609 |
| lhs_original |  697.34 | 0.09101 |  0.0387 |  0.088  | 0.20282 |
| avg_original | 447.115 | 0.17202 | 0.10378 | 0.17583 | 0.31945 |
|              |         |         |         |         |         |
| rhs_filtered |  167.86 |  0.4322 | 0.33583 | 0.47704 | 0.62367 |
| lhs_filtered |  344.45 | 0.22657 | 0.14336 | 0.25105 | 0.39622 |
| avg_filtered | 256.155 | 0.32938 |  0.2396 | 0.36405 | 0.50994 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 19:58:56,508 - [Embed_ConvE__2023-05-17-19h55m32s] - 
+---------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.   |
+--------------+--------+---------+---------+---------+---------+
|  Categories  |   MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+--------+---------+---------+---------+---------+
| rhs_original | 195.84 |  0.253  | 0.16882 | 0.26361 | 0.43619 |
| lhs_original | 701.1  | 0.09099 |  0.0387 |  0.0881 | 0.20307 |
| avg_original | 448.47 |  0.172  | 0.10376 | 0.17586 | 0.31963 |
|              |        |         |         |         |         |
| rhs_filtered | 166.78 |  0.4321 | 0.33573 | 0.47699 | 0.62342 |
| lhs_filtered | 344.78 | 0.22615 | 0.14321 | 0.25032 | 0.39553 |
| avg_filtered | 255.78 | 0.32913 | 0.23947 | 0.36366 | 0.50948 |
+--------------+--------+---------+---------+---------+---------+

2023-05-17 19:59:20,490 - [Embed_ConvE__2023-05-17-19h55m32s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  194.82 | 0.25301 | 0.16882 | 0.26356 | 0.43619 |
| lhs_original |  703.89 | 0.09097 |  0.0387 | 0.08795 | 0.20317 |
| avg_original | 449.355 | 0.17199 | 0.10376 | 0.17575 | 0.31968 |
|              |         |         |         |         |         |
| rhs_filtered |  165.74 | 0.43207 | 0.33568 | 0.47689 | 0.62333 |
| lhs_filtered |  345.11 | 0.22575 | 0.14302 | 0.25007 | 0.39524 |
| avg_filtered | 255.425 | 0.32891 | 0.23935 | 0.36348 | 0.50928 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 19:59:44,945 - [Embed_ConvE__2023-05-17-19h55m32s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  193.83 |  0.253  | 0.16882 | 0.26346 | 0.43633 |
| lhs_original |  706.06 | 0.09094 |  0.0387 | 0.08785 | 0.20302 |
| avg_original | 449.945 | 0.17197 | 0.10376 | 0.17566 | 0.31967 |
|              |         |         |         |         |         |
| rhs_filtered |  164.74 |  0.432  | 0.33563 | 0.47679 | 0.62328 |
| lhs_filtered |  345.43 |  0.2253 | 0.14277 | 0.24939 | 0.39446 |
| avg_filtered | 255.085 | 0.32865 |  0.2392 | 0.36309 | 0.50887 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 20:00:09,103 - [Embed_ConvE__2023-05-17-19h55m32s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  204.12 | 0.25358 | 0.16926 | 0.26444 | 0.43687 |
| lhs_original |  628.85 | 0.09378 | 0.03992 | 0.09049 | 0.20849 |
| avg_original | 416.485 | 0.17368 | 0.10459 | 0.17747 | 0.32268 |
|              |         |         |         |         |         |
| rhs_filtered |  175.65 | 0.43163 | 0.33475 | 0.47699 | 0.62362 |
| lhs_filtered |  344.19 |  0.2324 | 0.14673 | 0.25662 | 0.40946 |
| avg_filtered |  259.92 | 0.33202 | 0.24074 | 0.36681 | 0.51654 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 20:00:09,103 - [Embed_ConvE__2023-05-17-19h55m32s] - Prediction finished!
2023-05-17 20:00:09,103 - [Embed_ConvE__2023-05-17-19h55m32s] - The prediction results are saved in:
 /home/lyu4/workplace/SelfLearn/checkpoints/Embed_ConvE_FB15k237.pth
2023-05-17 20:00:33,188 - [Embed_ConvE__2023-05-17-19h55m32s] - 
+---------------------------------------------------------------------+
| Results on link prediction by relation category on FB15k237 dataset |
+--------------+------------+---------+---------+---------+-----------+
|              | Categories |   MRR   |  Hits@1 |  Hits@3 |  Hits@10  |
+--------------+------------+---------+---------+---------+-----------+
|              |    1to1    | 0.29205 | 0.16667 |  0.375  |  0.51042  |
|              |    1toN    | 0.08072 | 0.04038 | 0.07599 |  0.16296  |
| predict_head |    Nto1    | 0.45781 | 0.36272 | 0.49961 |  0.64888  |
|              |    NtoN    |  0.2548 | 0.15761 | 0.28494 |  0.45695  |
|              |            |         |         |         |           |
|              |    1to1    | 0.26691 | 0.15104 | 0.33854 |  0.46875  |
| predict_tail |    1toN    |  0.7667 | 0.70442 | 0.80932 |  0.87264  |
|              |    Nto1    | 0.05974 | 0.02552 | 0.05568 |   0.1222  |
|              |    NtoN    |  0.3715 |  0.2596 |  0.4216 |  0.59901  |
+--------------+------------+---------+---------+---------+-----------+

2023-05-17 20:00:33,188 - [Embed_ConvE__2023-05-17-19h55m32s] - The results of N2N:
+---------------------------------------------------------------------+
| Results on link prediction by relation category on FB15k237 dataset |
+--------------+------------+---------+---------+---------+-----------+
|              | Categories |   MRR   |  Hits@1 |  Hits@3 |  Hits@10  |
+--------------+------------+---------+---------+---------+-----------+
|              |    1to1    | 0.29205 | 0.16667 |  0.375  |  0.51042  |
|              |    1toN    | 0.08072 | 0.04038 | 0.07599 |  0.16296  |
| predict_head |    Nto1    | 0.45781 | 0.36272 | 0.49961 |  0.64888  |
|              |    NtoN    |  0.2548 | 0.15761 | 0.28494 |  0.45695  |
|              |            |         |         |         |           |
|              |    1to1    | 0.26691 | 0.15104 | 0.33854 |  0.46875  |
| predict_tail |    1toN    |  0.7667 | 0.70442 | 0.80932 |  0.87264  |
|              |    Nto1    | 0.05974 | 0.02552 | 0.05568 |   0.1222  |
|              |    NtoN    |  0.3715 |  0.2596 |  0.4216 |  0.59901  |
+--------------+------------+---------+---------+---------+-----------+
