2023-05-17 20:04:21,904 - [Embed_ConvE__2023-05-17-20h04m14s] - Embed_ConvE(
  (embeddings): Embeddings(
    (ent_embeddings): Parameters(14541, 200),
    (rel_embeddings): Parameters(474, 200)
    )
  (decoder): ConvE(
    (convolutions): ModuleList(
      (0): Sequential(
        (0): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (1): Conv2d(1, 200, kernel_size=(7, 7), stride=(1, 1), bias=False)
        (2): BatchNorm2d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (3): ReLU()
        (4): Dropout(p=0.2, inplace=False)
        (5): Flatten(start_dim=1, end_dim=-1)
        (6): Linear(in_features=39200, out_features=200, bias=True)
        (7): Dropout(p=0.3, inplace=False)
        (8): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (9): ReLU()
      )
    )
  )
  (bce_loss): BCELoss()
)
2023-05-17 20:04:21,905 - [Embed_ConvE__2023-05-17-20h04m14s] - 
DATA:
  NAME: FB15k237
  SMOOTH: 0.1
DECODER:
  CONVE_BIAS: False
  DECODER_FEAT_DROP: 0.2
  DECODER_HID_DROP: 0.3
  GAMMA: 40
  KER_SZ: 7
  K_H: 20
  K_W: 10
  NAME: ConvE
  NUM_FILTERS: 200
ENCODER:
  BIAS: False
  EMBED_DIM: 200
  ENCODER_DROP1: 0.3
  ENCODER_DROP2: 0.3
  ENCODER_GCN_BIAS: False
  ENCODER_GCN_DROP: 0.1
  GCN_HIDDEN_CHANNELS: 200
  GCN_IN_CHANNELS: 200
  GCN_NUM_LAYERS: 2
  GCN_OPN: sub
  GCN_OUT_CHANNELS: 200
  NAME: Embed
  NUM_BASES: -1
TRAIN:
  BATCH_SIZE: 256
  DEBUG: False
  EARLY_STOP_CNT: 30
  GPU: 2
  LENGTH: 3
  LOG_STEP: 100
  LR: 0.0001
  MAX_EPOCH: 1000
  NUM_WORKERS: 10
  SEED: 41504
  USE_APEX: False
  WEIGHT_DECAY: 0.0
2023-05-17 20:04:48,720 - [Embed_ConvE__2023-05-17-20h04m14s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  197.63 | 0.25355 | 0.13193 | 0.31413 | 0.49697 |
| lhs_original |  401.53 | 0.13639 | 0.06479 | 0.14175 | 0.28447 |
| avg_original |  299.58 | 0.19497 | 0.09836 | 0.22794 | 0.39072 |
|              |         |         |         |         |         |
| rhs_filtered |  177.95 | 0.41253 | 0.27265 | 0.51261 | 0.67385 |
| lhs_filtered |  246.58 | 0.28314 | 0.17659 | 0.32136 | 0.49868 |
| avg_filtered | 212.265 | 0.34784 | 0.22462 | 0.41698 | 0.58627 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 20:05:13,169 - [Embed_ConvE__2023-05-17-20h04m14s] - 
+---------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.   |
+--------------+--------+---------+---------+---------+---------+
|  Categories  |   MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+--------+---------+---------+---------+---------+
| rhs_original | 195.7  | 0.25482 | 0.13408 | 0.31359 | 0.49673 |
| lhs_original | 402.76 | 0.13618 | 0.06474 | 0.14136 | 0.28389 |
| avg_original | 299.23 |  0.1955 | 0.09941 | 0.22747 | 0.39031 |
|              |        |         |         |         |         |
| rhs_filtered | 175.91 | 0.41489 | 0.27592 | 0.51339 | 0.67497 |
| lhs_filtered | 244.69 | 0.28478 | 0.17878 | 0.32234 | 0.49976 |
| avg_filtered | 210.3  | 0.34984 | 0.22735 | 0.41787 | 0.58736 |
+--------------+--------+---------+---------+---------+---------+

2023-05-17 20:05:36,972 - [Embed_ConvE__2023-05-17-20h04m14s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  193.85 | 0.25724 | 0.13779 |  0.3133 | 0.49599 |
| lhs_original |  403.92 | 0.13554 | 0.06445 | 0.14038 | 0.28325 |
| avg_original | 298.885 | 0.19639 | 0.10112 | 0.22684 | 0.38962 |
|              |         |         |         |         |         |
| rhs_filtered |  173.88 | 0.41876 | 0.28081 | 0.51427 | 0.67649 |
| lhs_filtered |  242.67 | 0.28625 | 0.17976 | 0.32439 | 0.50318 |
| avg_filtered | 208.275 | 0.35251 | 0.23029 | 0.41933 | 0.58983 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 20:06:00,771 - [Embed_ConvE__2023-05-17-20h04m14s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  192.19 | 0.26689 | 0.15367 | 0.31139 | 0.49477 |
| lhs_original |  410.6  | 0.13352 | 0.06323 | 0.13794 | 0.27973 |
| avg_original | 301.395 | 0.20021 | 0.10845 | 0.22467 | 0.38725 |
|              |         |         |         |         |         |
| rhs_filtered |  171.91 | 0.43163 | 0.29967 | 0.51656 | 0.67971 |
| lhs_filtered |  240.77 | 0.28788 | 0.18069 |  0.3285 | 0.50635 |
| avg_filtered |  206.34 | 0.35976 | 0.24018 | 0.42253 | 0.59303 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 20:06:24,748 - [Embed_ConvE__2023-05-17-20h04m14s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  192.01 | 0.27739 | 0.17722 |  0.3047 | 0.48427 |
| lhs_original |  489.12 | 0.11976 | 0.05565 |  0.1225 | 0.25266 |
| avg_original | 340.565 | 0.19858 | 0.11643 |  0.2136 | 0.36846 |
|              |         |         |         |         |         |
| rhs_filtered |  169.98 |  0.4509 | 0.33055 | 0.51964 | 0.68015 |
| lhs_filtered |  240.18 | 0.28917 | 0.17815 | 0.33543 |  0.5107 |
| avg_filtered |  205.08 | 0.37004 | 0.25435 | 0.42753 | 0.59543 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 20:06:48,818 - [Embed_ConvE__2023-05-17-20h04m14s] - 
+---------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.   |
+--------------+--------+---------+---------+---------+---------+
|  Categories  |   MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+--------+---------+---------+---------+---------+
| rhs_original | 192.57 | 0.27507 | 0.17556 | 0.30294 | 0.47899 |
| lhs_original | 569.19 | 0.11602 | 0.05355 | 0.11917 | 0.24431 |
| avg_original | 380.88 | 0.19554 | 0.11455 | 0.21105 | 0.36165 |
|              |        |         |         |         |         |
| rhs_filtered | 168.21 | 0.44922 |  0.3284 | 0.51842 | 0.67971 |
| lhs_filtered | 246.65 | 0.27766 | 0.17097 |  0.322  | 0.49062 |
| avg_filtered | 207.43 | 0.36344 | 0.24969 | 0.42021 | 0.58517 |
+--------------+--------+---------+---------+---------+---------+

2023-05-17 20:07:12,872 - [Embed_ConvE__2023-05-17-20h04m14s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  191.21 |  0.2745 | 0.17497 | 0.30275 | 0.47835 |
| lhs_original |  582.22 | 0.11526 | 0.05277 | 0.11893 | 0.24328 |
| avg_original | 386.715 | 0.19488 | 0.11387 | 0.21084 | 0.36081 |
|              |         |         |         |         |         |
| rhs_filtered |  166.49 | 0.44769 | 0.32688 | 0.51686 | 0.67795 |
| lhs_filtered |  250.22 | 0.27449 | 0.16843 | 0.31775 | 0.48632 |
| avg_filtered | 208.355 | 0.36109 | 0.24766 |  0.4173 | 0.58214 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 20:07:36,867 - [Embed_ConvE__2023-05-17-20h04m14s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  189.71 | 0.27429 | 0.17483 | 0.30275 | 0.47787 |
| lhs_original |  587.54 | 0.11498 | 0.05253 | 0.11893 | 0.24299 |
| avg_original | 388.625 | 0.19464 | 0.11368 | 0.21084 | 0.36043 |
|              |         |         |         |         |         |
| rhs_filtered |  164.83 | 0.44731 | 0.32683 | 0.51632 | 0.67605 |
| lhs_filtered |  252.26 | 0.27187 | 0.16598 | 0.31506 |  0.4829 |
| avg_filtered | 208.545 | 0.35959 |  0.2464 | 0.41569 | 0.57947 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 20:08:00,923 - [Embed_ConvE__2023-05-17-20h04m14s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  188.18 | 0.27423 | 0.17478 |  0.3027 | 0.47772 |
| lhs_original |  590.19 | 0.11493 | 0.05258 | 0.11888 | 0.24294 |
| avg_original | 389.185 | 0.19458 | 0.11368 | 0.21079 | 0.36033 |
|              |         |         |         |         |         |
| rhs_filtered |  163.21 | 0.44699 | 0.32659 | 0.51588 | 0.67512 |
| lhs_filtered |  253.11 | 0.27036 | 0.16486 | 0.31325 | 0.48104 |
| avg_filtered |  208.16 | 0.35867 | 0.24572 | 0.41456 | 0.57808 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 20:08:24,842 - [Embed_ConvE__2023-05-17-20h04m14s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  186.65 |  0.2742 | 0.17478 | 0.30265 | 0.47777 |
| lhs_original |  591.61 | 0.11489 | 0.05258 | 0.11888 | 0.24274 |
| avg_original |  389.13 | 0.19454 | 0.11368 | 0.21076 | 0.36025 |
|              |         |         |         |         |         |
| rhs_filtered |  161.61 | 0.44659 |  0.3263 | 0.51534 | 0.67507 |
| lhs_filtered |  253.64 | 0.26954 | 0.16461 | 0.31286 | 0.48031 |
| avg_filtered | 207.625 | 0.35806 | 0.24545 |  0.4141 | 0.57769 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 20:08:50,161 - [Embed_ConvE__2023-05-17-20h04m14s] - 
+----------------------------------------------------------------+
|   The results of the FB15k237 datasets on the Test Process.    |
+--------------+---------+---------+---------+---------+---------+
|  Categories  |    MR   |   MRR   |  Hits@1 |  Hits@3 | Hits@10 |
+--------------+---------+---------+---------+---------+---------+
| rhs_original |  192.01 | 0.27739 | 0.17722 |  0.3047 | 0.48427 |
| lhs_original |  489.12 | 0.11976 | 0.05565 |  0.1225 | 0.25266 |
| avg_original | 340.565 | 0.19858 | 0.11643 |  0.2136 | 0.36846 |
|              |         |         |         |         |         |
| rhs_filtered |  169.98 |  0.4509 | 0.33055 | 0.51964 | 0.68015 |
| lhs_filtered |  240.18 | 0.28917 | 0.17815 | 0.33543 |  0.5107 |
| avg_filtered |  205.08 | 0.37004 | 0.25435 | 0.42753 | 0.59543 |
+--------------+---------+---------+---------+---------+---------+

2023-05-17 20:08:50,161 - [Embed_ConvE__2023-05-17-20h04m14s] - Prediction finished!
2023-05-17 20:08:50,161 - [Embed_ConvE__2023-05-17-20h04m14s] - The prediction results are saved in:
 /home/lyu4/workplace/SelfLearn/checkpoints/Embed_ConvE_FB15k237_MAGIC.pth
2023-05-17 20:09:15,229 - [Embed_ConvE__2023-05-17-20h04m14s] - 
+---------------------------------------------------------------------+
| Results on link prediction by relation category on FB15k237 dataset |
+--------------+------------+---------+---------+---------+-----------+
|              | Categories |   MRR   |  Hits@1 |  Hits@3 |  Hits@10  |
+--------------+------------+---------+---------+---------+-----------+
|              |    1to1    |  0.4059 | 0.29688 | 0.45833 |  0.59375  |
|              |    1toN    | 0.22379 | 0.12306 | 0.26404 |  0.42127  |
| predict_head |    Nto1    | 0.44636 | 0.33488 | 0.50735 |  0.66357  |
|              |    NtoN    | 0.29241 | 0.17849 | 0.33901 |  0.52156  |
|              |            |         |         |         |           |
|              |    1to1    | 0.40456 | 0.29688 | 0.45833 |  0.57812  |
| predict_tail |    1toN    | 0.72467 | 0.61959 | 0.81147 |  0.88292  |
|              |    Nto1    | 0.23949 | 0.16087 | 0.25599 |  0.40603  |
|              |    NtoN    | 0.39254 | 0.26406 | 0.46094 |  0.64808  |
+--------------+------------+---------+---------+---------+-----------+

2023-05-17 20:09:15,229 - [Embed_ConvE__2023-05-17-20h04m14s] - The results of N2N:
+---------------------------------------------------------------------+
| Results on link prediction by relation category on FB15k237 dataset |
+--------------+------------+---------+---------+---------+-----------+
|              | Categories |   MRR   |  Hits@1 |  Hits@3 |  Hits@10  |
+--------------+------------+---------+---------+---------+-----------+
|              |    1to1    |  0.4059 | 0.29688 | 0.45833 |  0.59375  |
|              |    1toN    | 0.22379 | 0.12306 | 0.26404 |  0.42127  |
| predict_head |    Nto1    | 0.44636 | 0.33488 | 0.50735 |  0.66357  |
|              |    NtoN    | 0.29241 | 0.17849 | 0.33901 |  0.52156  |
|              |            |         |         |         |           |
|              |    1to1    | 0.40456 | 0.29688 | 0.45833 |  0.57812  |
| predict_tail |    1toN    | 0.72467 | 0.61959 | 0.81147 |  0.88292  |
|              |    Nto1    | 0.23949 | 0.16087 | 0.25599 |  0.40603  |
|              |    NtoN    | 0.39254 | 0.26406 | 0.46094 |  0.64808  |
+--------------+------------+---------+---------+---------+-----------+
